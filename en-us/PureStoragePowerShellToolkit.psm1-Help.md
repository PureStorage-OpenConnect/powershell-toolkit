# Get-AllHostVolumeInfo

## SYNOPSIS
Retrieves Host Volume information from FlashArray.

## SYNTAX

### Set 1
```
Get-AllHostVolumeInfo [-EndPoint] <String> [<CommonParameters>]
```

## DESCRIPTION
Retrieves Host Volume information including volumes attributes from a FlashArray.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-HostVolumeinfo -EndPoint myarray.mydomain.com
```

Retrieves Host Volume information from the FlashArray myarray.mydomain.com.

## PARAMETERS

### EndPoint


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### EndPoint IP or FQDN required


## OUTPUTS

### Outputs Host volume information


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-FlashArrayConfig

## SYNOPSIS
Retrieves and outputs to a file the configuration of the FlashArray.

## SYNTAX

### Set 1
```
Get-FlashArrayConfig [-EndPoint] <String> [-OutFile <String>] [-ArrayName <String>] [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will run Purity CLI commands to retrieve the base configuration of a FlashArray and output it to a file. This file is formatted for the CLI, not necessarily human-readable.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-FlashArray -EndPoint myArray -ArrayName Array100
```

Retrieves the configuration for a FlashArray and stores it in the current path as Array100_config.txt.

## PARAMETERS

### EndPoint
Required. FQDN or IP address of the FlashArray.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### OutFile
Optional. The file path and filename that will contain the output. if not specified, the default is the current folder\\Array_Config.txt.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: Array_Config.txt
Pipeline Input: false
```

### ArrayName
Optional. The FlashArray name to use in the output. Defaults to $EndPoint.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### Configuration file.


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-FlashArrayDisconnectedVolumes

## SYNOPSIS
Retrieves disconnected volume information for a FlashArray.

## SYNTAX

### Set 1
```
Get-FlashArrayDisconnectedVolumes [-EndPoint] <String> [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will retrieve information for volumes that are ina disconnected state for a FlashArray.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-FlashArrayDisconnectedVolumes -EndPoint myArray
```

## PARAMETERS

### EndPoint


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### Disconnected volume information is displayed.


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-FlashArrayHierarchy

## SYNOPSIS
Displays array hierarchy in relation to hosts and/or volumes.

## SYNTAX

### Set 1
```
Get-FlashArrayHierarchy [-EndPoint] <String> [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will display the hierarchy from a FlashArray of hosts and volumes. The output is to the console in text.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-FlashArrayHierarchy -EndPoint myArray
```

## PARAMETERS

### EndPoint


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### FlashArray host and/or volume hierarchy.


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-FlashArrayPgroupsConfig

## SYNOPSIS
Retrieves Protection Group (PGroup) information for the FlashArray.

## SYNTAX

### Set 1
```
Get-FlashArrayPgroupsConfig [-EndPoint] <String> [<CommonParameters>]
```

## DESCRIPTION
Retrieves Protection Group (PGroup) information for the FlashArray.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-FlashArrayPgroupsConfig -EndPoint myArrayg
```

## PARAMETERS

### EndPoint


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### Protection Group information is displayed.


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-FlashArrayQuickCapacityStats

## SYNOPSIS
Quick way to retrieve FlashArray capacity statistics.

## SYNTAX

### Set 1
```
Get-FlashArrayQuickCapacityStats [-Names] <String> [<CommonParameters>]
```

## DESCRIPTION
Retrieves high level capcity statistics from a FlashArray.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-FlashArrayQuickCapacityStats -Names 'array1, array2'
```

Retrieves capacity statistic information from FlashArray's array1 and array2.

## PARAMETERS

### Names


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### Single or multiple FlashArray IP addresses or FQDNs.


## OUTPUTS

### Outputs array capacity information


## NOTES

The arrays supplied in the "Names" parameter must use the same credentials for access.

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-FlashArrayRASession

## SYNOPSIS
Retrieves Remote Assist status from a FlashArray.

## SYNTAX

### Set 1
```
Get-FlashArrayRASession [-EndPoint] <String> [<CommonParameters>]
```

## DESCRIPTION
Retrieves Remote Assist status from a FlashArray as disabled or enabled in a loop every 30 seconds until stopped.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-FlashArrayRASession -EndPoint myarray.mydomain.com
```

Retrieves the current Remote Assist status and continues check status every 30 seconds until stopped.

## PARAMETERS

### EndPoint


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### EndPoint IP or FQDN required.


## OUTPUTS

### Outputs Remote Assst status.


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-FlashArraySerialNumbers

## SYNOPSIS
Retrieves FlashArray volume serial numbers connected to the host.

## SYNTAX

### Set 1
```
Get-FlashArraySerialNumbers
```

## DESCRIPTION
Cmdlet queries WMI on the localhost to retrieve the disks that are associated to Pure FlashArrays.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-FlashArraySerialNumbers
```

Returns serial number information on Pure FlashArray disk devices connected to the host.

## PARAMETERS

## INPUTS

### EndPoint IP or FQDN required.


## OUTPUTS

### Outputs serial numbers of FlashArrays devices.


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-FlashArrayStaleSnapshots

## SYNOPSIS
Retrieves aged snapshots and allows for Deletion and Eradication of such snapshots.

## SYNTAX

### Set 1
```
Get-FlashArrayStaleSnapshots [-EndPoint] <String> -SnapAgeThreshold <String> [-Delete] [-Eradicate] [-Confirm] [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will retrieve all snapshots that are beyond the specified SnapAgeThreshold. It allows for the parameters of Delete and Eradicate, and if set to $true, it will delete and eradicate the snapshots returned. It allows for the parameter of Confirm, and if set to $true, it will prompt before deletion and/or eradication of the snapshots.
Snapshots must be deleted before they can be eradicated.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-FlashArrayStaleSnapshots -EndPoint myArray -SnapAgeThreshold 30
```

Returns all snapshots that are older than 30 days from the current date.

### -------------------------- EXAMPLE 2 --------------------------
PS C:\\\>
```powershell
Get-FlashArrayStaleSnapshots -EndPoint myArray -SnapAgeThreshold 30 -Delete:$true -Eradicate:$true -Confirm:$false
```

Returns all snapshots that are older than 30 days from the current date, deletes and eradicates them without confirmation.

## PARAMETERS

### EndPoint
Required. Endpoint is the FlashArray IP or FQDN.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### SnapAgeThreshold
Required. SnapAgeThreshold is the number of days from the current date. Delete. Confirm, and Eradicate are optional.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: named
Default Value: 
Pipeline Input: false
```

### Delete
Optional. If set to $true, delete the snapshots.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### Eradicate
Optional. If set to $true, eradicate the deleted snapshots (snapshot must be flagged as deleted).

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### Confirm
Optional. If set to $true, provide user confirmation for Deletion or Eradication of the snapshots.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

### Returns a listing of snapshots that are beyond the specified threshold and displays final results.


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-FlashArrayVolumeGrowth

## SYNOPSIS
Retrieves volume growth information over past X days at X percentage of growth.

## SYNTAX

### Set 1
```
Get-FlashArrayVolumeGrowth [-Arrays] <String[]> [-MinimumVolumeAgeInDays] <String> [-TimeFrameToCompareWith] <String> [-GrowthPercentThreshold] <String> [[-DoNotReportGrowthOfLessThan] <String>] [[-DoNotReportVolSmallerThan] <String>] [-csv] [-html] [<CommonParameters>]
```

## DESCRIPTION
Retrieves volume growth in GB from a FlashArray for volumes that grew in past X amount of days at X percentage of growth.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-FlashArrayVolumeGrowth -Arrays array1,array2 -GrowthPercentThreshold '10' -MinimumVolumeAgeInDays '1' -TimeFrameToCompareWith '7d' -DoNotReportGrowthOfLessThan '1' -DoNotReportVolSmallerThan '1GB' -csv
```

Retrieve volume capacity report for array 1 and array2 comparing volumes over the last 7 days that:
    - volumes that are not smaller than 1GB in size
    - must have growth of less than 1GB
    - that are at least 1 day old
    - have grown at least 10%
    - output the report to a CSV delimited file

## PARAMETERS

### Arrays
Required. An IP address or FQDN of the FlashArray(s). Multiple arrys can be specified, seperated by commas. Only use single-quotes or no quotes around the arrays parameter object. Ex. -Arrays array1,array2,array3 --or-- -Arrays 'array1,array2,array3'

```yaml
Type: String[]
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### MinimumVolumeAgeInDays
Optional. The minimum age in days that a volume must be to report on it. If not specified, defaults to 1 day.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 1
Default Value: 1
Pipeline Input: false
```

### TimeFrameToCompareWith
Required. The timeframe to compare the volume size against. Accepts '1h', '3h', '24h', '7d', '30d', '90d', '1y'.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 2
Default Value: 
Pipeline Input: false
```

### GrowthPercentThreshold
Optional. The minimum percentage of volume growth to report on. Specified as a numerical value from 1-99. If not specified, defaults to '1'.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 3
Default Value: 1
Pipeline Input: false
```

### DoNotReportGrowthOfLessThan
Optional. If growth in size, in Gigabytes, over the specified period is lower than this value, it will not be reported. Specified as a numerical value. If not specified, defaults to '1'.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 4
Default Value: 1
Pipeline Input: false
```

### DoNotReportVolSmallerThan
Optional. Volumes that are smaller than this size in Gigabytes will not be reported on. Specified as a numerical value + GB. If not specified, defaults to '1GB'.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 5
Default Value: 1GB
Pipeline Input: false
```

### csv
Optional. Switch. If present, produces a csv comma-delimited file of the output in the current folder named FlashArrayVolumeGrowthReport.csv.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### html
Optional. Switch. If present, produces a HTML of the output in the current folder named FlashArrayVolumeGrowthReport.html.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### Specified inputs to calculate volumes reported on.


## OUTPUTS

### Volume capacity information to the console, and also to a CSV and/or HTML formatted report (if specified).


## NOTES

All arrays specified must use th same credential login.

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-HostBusAdapter

## SYNOPSIS
Retrieves host Bus Adapater (HBA) information.

## SYNTAX

### Set 1
```
Get-HostBusAdapter [[-ComputerName] <String>] [<CommonParameters>]
```

## DESCRIPTION
Retrieves host Bus Adapater (HBA) information for the host.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-HostBusAdapter -ComputerName myComputer
```

## PARAMETERS

### ComputerName


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### Computer name is optional.


## OUTPUTS

### Host Bus Adapter information.


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-MPIODiskLBPolicy

## SYNOPSIS
Retrieves the current MPIO Load Balancing policy for Pure FlashArray disk(s).

## SYNTAX

### Set 1
```
Get-MPIODiskLBPolicy [[-DiskId] <String>] [[-OutFile] <String>] [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will retrieve the current MPIO Load Balancing policy for connected Pure FlashArrays disk(s) using the mpclaim.exe utlity.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-MPIODiskLBPolicy -DiskID 1
```

Returns the current MPIO LB policy for disk ID 1.

## PARAMETERS

### DiskId
Optional. If specified, retrieves only the policy for the that disk ID. Otherwise, returns all disks.
DiskID is the 'Number' identifier of the disk from the cmdlet 'Get-Disk'.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 0
Default Value: 
Pipeline Input: false
```

### OutFile
Optional. File name to output results to. Defaults to %TEMP%\\MPIOLBPolicy.txt

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 1
Default Value: "$env:Temp\output.txt"
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### Outputs $OutFile contents.


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-QuickFixEngineering

## SYNOPSIS
Retrieves all the Windows OS QFE patches applied.

## SYNTAX

### Set 1
```
Get-QuickFixEngineering
```

## DESCRIPTION
Retrieves all the Windows OS QFE patches applied.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-QuickFixEngineering
```

## PARAMETERS

## INPUTS

### None


## OUTPUTS

### Outputs a listing of QFE patches applied.


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-VolumeShadowCopy

## SYNOPSIS
Retrieves the volume shadow copy informaion using the Diskhadow command.

## SYNTAX

### Set 1
```
Get-VolumeShadowCopy [[-ScriptName] <String>] [-MetadataFile] <String> [-ShadowCopyAlias] <String> [-ExposeAs] <String> [[-VerboseMode] <String>] [<CommonParameters>]
```

## DESCRIPTION


## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-VolumeShadowCopy -MetadataFile myFile.cab -ShadowCopyAlias MyAlias -ExposeAs MyShadowCopy
```

Exposes the MyAias shadow copy as drive latter G: using the myFie.cab metadata file.

## PARAMETERS

### ScriptName
Optional. Script text file name created to pass to the Diskshadow command. defaults to 'PUREVSS-SNAP'.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 0
Default Value: PUREVSS-SNAP
Pipeline Input: false
```

### MetadataFile
Required. Full filename for the metadata .cab file. It must exist in the current working folder.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 1
Default Value: 
Pipeline Input: false
```

### ShadowCopyAlias
Required. Name of the shadow copy alias.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 2
Default Value: 
Pipeline Input: false
```

### ExposeAs
Required. Drive letter, share, or mount point to expose the shadow copy.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 3
Default Value: 
Pipeline Input: false
```

### VerboseMode
Optional. "On" or "Off". If set to 'off', verbose mode for the Diskshadow command is disabled. Default is 'On'.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 4
Default Value: On
Accepted Values: On
                 Off
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### None


## NOTES

See https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow for more information on the Diskshadow utility.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Get-WindowsDiagnosticInfo

## SYNOPSIS
Gathers Windows operating system, hardware, and software information, including logs for diagnostics. This cmdlet requires Administrative permissions.

## SYNTAX

### Set 1
```
Get-WindowsDiagnosticInfo [-Cluster] [-Compress] [<CommonParameters>]
```

## DESCRIPTION
This script will collect detailed information on the Windows operating system, hardware and software components, and collect event logs in .evtx and .csv formats. It will optionally collect WSFC logs and optionally compress all gathered files intoa .zip file for easy distribution.
This script will place all of the files in a parent folder in the root of the C:\\ drive that is named after the computer NetBios name($env:computername).
Each section of information gathered will have it's own child folder in that parent folder.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Get-WindowsDiagnosticInfo.ps1 -Cluster
```

Retrieves all of the operating system, hardware, software, event log, and WSFC logs into the default folder.

### -------------------------- EXAMPLE 2 --------------------------
PS C:\\\>
```powershell
Get-WindowsDiagnosticInfo.ps1 -Compress
```

Retrieves all of the operating system, hardware, software, event log, and compresses the parent folder into a zip file that will be created in the root of the C: drive.

## PARAMETERS

### Cluster
Optional. Collect Windows Server Failover Cluster (WSFC) logs.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### Compress
Optional. Compress the folder that contains all the gathered data into a zip file. The file name will be the computername_diagnostics.zip.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### Diagnostic outputs in txt and event log files.
Compressed zip file.


## NOTES

This cmdlet requires Administrative permissions.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Invoke-DynamicDataMasking

## SYNOPSIS
A PowerShell function to apply data masks to database columns using the SQL Server dynamic data masking feature.

## SYNTAX

### Set 1
```
Invoke-DynamicDataMasking [-SqlInstance] <String> [-Database] <String> [<CommonParameters>]
```

## DESCRIPTION
This function uses the information stored in the extended properties of a database:
sys.extended_properties.name = 'DATAMASK' to obtain the dynamic data masking function to apply
at column level. Columns of the following data type are currently supported:

- int
- bigint
- char
- nchar
- varchar
- nvarchar

Using the c_address column in the tpch customer table as an example, the DATAMASK extended property can be applied
to the column as follows:

exec sp_addextendedproperty
     @name = N'DATAMASK'
    ,@value = N'(FUNCTION = 'partial(0, "XX", 20)''
    ,@level0type = N'Schema', @level0name = 'dbo'
    ,@level1type = N'Table',  @level1name = 'customer'
    ,@level2type = N'Column', @level2name = 'c_address'
GO

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Invoke-DynamicDataMasking -SqlInstance Z-STN-WIN2016-A\DEVOPSDEV -Database tpch-no-compression
```

## PARAMETERS

### SqlInstance
Required. The SQL Server instance of the database that data masking is to be applied to.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### Database
Required. The database that data masking is to be applied to.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 1
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

## NOTES

Note that it has dependencies on the dbatools and PureStoragePowerShellSDK  modules which are installed as part of this module.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Invoke-FlashArrayDbRefresh

## SYNOPSIS
A PowerShell function to refresh one or more SQL Server databases (the destination) from either a snapshot or database.

## SYNTAX

### Set 1
```
Invoke-FlashArrayDbRefresh [-RefreshDatabase] <String> [-RefreshSource] <String> [-DestSqlInstances] <String[]> [-Endpoint] <String> [[-PollJobInterval] <Int32>] [[-StaticDataMaskFile] <String>] [-PromptForSnapshot] [-RefreshFromSnapshot] [-NoPsRemoting] [-ApplyDataMasks] [-ForceDestDbOffline] [<CommonParameters>]
```

## DESCRIPTION
A PowerShell function to refresh one or more SQL Server databases either from:
- a snapshot specified by its name
- a snapshot picked from a list associated with the volume the source database resides on
- a source database directly

This  function will detect and repair orpaned users in refreshed databases and optionally
apply data masking, based on either:
- the dynamic data masking functionality available in SQL Server version 2016 onwards,
- static data masking built into dbatools from version 0.9.725, refer to https://dbatools.io/mask/

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Invoke-FlashArrayDbRefresh -RefreshDatabase tpch-no-compression -RefreshSource z-sql2016-devops-prd -DestSqlInstance z-sql2016-devops-tst -Endpoint 10.225.112.10 `
```

-PromptForSnapshot

Refresh a single database from a snapshot selected from a list of snapshots associated with the volume specified by the RefreshSource parameter.

### -------------------------- EXAMPLE 2 --------------------------
PS C:\\\>
```powershell
$Targets = @("z-sql2016-devops-tst", "z-sql2016-devops-dev")
```

Invoke-FlashArrayDbRefresh -RefreshDatabase tpch-no-compression -RefreshSource z-sql2016-devops-prd -DestSqlInstance $Targets -Endpoint 10.225.112.10 \`
-PromptForSnapshot

Refresh multiple databases from a snapshot selected from a list of snapshots associated with the volume specified by the RefreshSource parameter.

### -------------------------- EXAMPLE 3 --------------------------
PS C:\\\>
```powershell
Invoke-FlashArrayDbRefresh -RefreshDatabase tpch-no-compression -RefreshSource source-snap -DestSqlInstance z-sql2016-devops-tst -Endpoint 10.225.112.10 `
```

-RefreshFromSnapshot

Refresh a single database using the snapshot specified by the RefreshSource parameter.

### -------------------------- EXAMPLE 4 --------------------------
PS C:\\\>
```powershell
$Targets = @("z-sql2016-devops-tst", "z-sql2016-devops-dev")
```

Invoke-FlashArrayDbRefresh -RefreshDatabase tpch-no-compression -RefreshSource source-snap -DestSqlInstance $Targets -Endpoint 10.225.112.10 \`
-RefreshFromSnapshot

Refresh multiple databases using the snapshot specified by the RefreshSource parameter.

### -------------------------- EXAMPLE 5 --------------------------
PS C:\\\>
```powershell
Invoke-FlashArrayDbRefresh -$RefreshDatabase tpch-no-compression -RefreshSource z-sql-prd -DestSqlInstance z-sql2016-devops-tst -Endpoint 10.225.112.10
```

Refresh a single database from the database specified by the SourceDatabase parameter residing on the instance specified by RefreshSource.

### -------------------------- EXAMPLE 6 --------------------------
PS C:\\\>
```powershell
$Targets = @("z-sql2016-devops-tst", "z-sql2016-devops-dev")
```

Invoke-FlashArrayDbRefresh -$RefreshDatabase tpch-no-compression -RefreshSource z-sql-prd -DestSqlInstance $Targets -Endpoint 10.225.112.10 \`

Refresh multiple databases from the database specified by the SourceDatabase parameter residing on the instance specified by RefreshSource.

### -------------------------- EXAMPLE 7 --------------------------
PS C:\\\>
```powershell
$Targets = @("z-sql2016-devops-tst", "z-sql2016-devops-dev")
```

Invoke-PfaDbRefresh -$RefreshDatabase tpch-no-compression -RefreshSource z-sql-prd -DestSqlInstance $Targets -Endpoint 10.225.112.10 \`
-ApplyDataMasks

Refresh multiple databases from the database specified by the SourceDatabase parameter residing on the instance specified by RefreshSource.

### -------------------------- EXAMPLE 8 --------------------------
PS C:\\\>
```powershell
$StaticDataMaskFile = "D:\apps\datamasks\z-sql-prd.tpch-no-compression.tables.json"
```

$Targets = @("z-sql2016-devops-tst", "z-sql2016-devops-dev")
Invoke-FlashArrayDbRefresh -$RefreshDatabase tpch-no-compression -RefreshSource z-sql-prd -DestSqlInstance $Targets -Endpoint 10.225.112.10 \`
-StaticDataMaskFile $StaticDataMaskFile

Refresh multiple databases from the database specified by the SourceDatabase parameter residing on the instance specified by RefreshSource and apply SQL Server dynamic data masking to each database.

### -------------------------- EXAMPLE 9 --------------------------
PS C:\\\>
```powershell
$StaticDataMaskFile = "D:\apps\datamasks\z-sql-prd.tpch-no-compression.tables.json"
```

$Targets = @("z-sql2016-devops-tst", "z-sql2016-devops-dev")
Invoke-FlashArrayDbRefresh -$RefreshDatabase tpch-no-compression -RefreshSource z-sql-prd -DestSqlInstance $Targets -Endpoint 10.225.112.10 \`
-ForceDestDbOffline -StaticDataMaskFile $StaticDataMaskFile

Refresh multiple databases from the database specified by the SourceDatabase parameter residing on the instance specified by RefreshSource and apply SQL Server dynamic data masking to each database.
All databases to be refreshed are forced offline prior to their underlying FlashArray volumes being overwritten.

### -------------------------- EXAMPLE 10 --------------------------
PS C:\\\>
```powershell
$StaticDataMaskFile = "D:\apps\datamasks\z-sql-prd.tpch-no-compression.tables.json"
```

$Targets = @("z-sql2016-devops-tst", "z-sql2016-devops-dev")
Invoke-FlashArrayDbRefresh -$RefreshDatabase tpch-no-compression -RefreshSource z-sql-prd -DestSqlInstance $Targets -Endpoint 10.225.112.10 \`
-PollJobInterval 10 -ForceDestDbOffline -StaticDataMaskFile $StaticDataMaskFile

Refresh multiple databases from the database specified by the SourceDatabase parameter residing on the instance specified by RefreshSource and apply SQL Server dynamic data masking to each database.
All databases to be refreshed are forced offline prior to their underlying FlashArray volumes being overwritten. Poll the status of the refresh jobs once every 10 seconds.

## PARAMETERS

### RefreshDatabase
Required. The name of the database to refresh, note that it is assumed that source and target database(s) are named the same.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### RefreshSource
Required. If the RefreshFromSnapshot flag is specified, this parameter takes the name of a snapshot, otherwise this takes the
name of the source SQL Server instance.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 1
Default Value: 
Pipeline Input: false
```

### DestSqlInstances


```yaml
Type: String[]
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 2
Default Value: 
Pipeline Input: false
```

### Endpoint
Required. The IP address representing the FlashArray that the volumes for the source and refresh target databases reside on.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 3
Default Value: 
Pipeline Input: false
```

### PollJobInterval
Optional. Interval at which background job status is poll, if this is ommited polling will not take place. Note that this parameter
is not applicable is the PromptForSnapshot switch is specified.

```yaml
Type: Int32
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 4
Default Value: 0
Pipeline Input: false
```

### PromptForSnapshot
Optional. This is an optional flag that if specified will result in a list of snapshots being displayed for the database volume on
the FlashArray that the user can select one from. Despite the source of the refresh operation being an existing snapshot,
 the source instance still has to be specified by the RefreshSource parameter in order that the function can determine
which FlashArray volume to list existing snapshots for.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### RefreshFromSnapshot
Optional. This is an optional flag that if specified causes the function to expect the RefreshSource parameter to be supplied with
the name of an existing snapshot.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### NoPsRemoting
Optional. The commands that off and online the windows volumes associated with the refresh target databases will use Invoke-Command
with powershell remoting unless this flag is specified. Certain tools that can invoke PowerShell, Ansible for example, do
not permit double-hop authentication unless CredSSP authentication is used. For security purposes Kerberos is recommended
over CredSSP, however this does not support double-hop authentication, in which case this flag should be specified.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### ApplyDataMasks
Optional. Specifying this optional masks will cause data masks to be applied , as per the dynamic data masking feature first
introduced with SQL Server 2016, this results in this function invoking the Invoke-DynamicDataMasking function to be invoked.
For documentation on Invoke-DynamicDataMasking, use the command Get-Help Invoke-DynamicDataMasking -Detailed.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### ForceDestDbOffline
Optional. Specifying this switch will cause refresh target databases for be forced offline via WITH ROLLBACK IMMEDIATE.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### StaticDataMaskFile
Optional. If this parameter is present and has a file path associated with it, the data masking available in version 0.9.725 of the
dbatools module onwards will be applied  to the refreshed database. The use of this is contigent on the data mask file
being created and populated in the first place as per this blog post: https://dbatools.io/mask/ .

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 5
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

## NOTES

FlashArray Credentials - A global variable $Creds may be used as described in the release notes for this module. If neither is specified, the module will prompt for credentials.

Known Restrictions
------------------
1. This function does not work for databases associated with failover cluster instances.
2. This function cannot be used to seed secondary replicas in availability groups using databases in the primary replica.
3. The function assumes that all database files and the transaction log reside on a single FlashArray volume.

Note that it has dependencies on the dbatools and PureStoragePowerShellSDK modules which are installed by this module.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Invoke-StaticDataMasking

## SYNOPSIS
A PowerShell function to statically mask data in char, varchar and/or nvarchar columns using a MD5 hashing function.

## SYNTAX

### Set 1
```
Invoke-StaticDataMasking [-SqlInstance] <String> [-Database] <String> [-DataMaskFile] <String> [<CommonParameters>]
```

## DESCRIPTION
This PowerShell function uses as input a JSON file created by calling the New-DbaDbMaskingConfig PowerShell function.
Data in the columns specified in this file which are of the type char, varchar or nvarchar are envrypted using a MD5
hash.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Invoke-StaticDataMasking -SqlInstance  Z-STN-WIN2016-A\DEVOPSDEV -Database tpch-no-compression -DataMaskFile 'C:\Users\devops\Documents\tpch-no-compression.tables.json'
```

## PARAMETERS

### SqlInstance
Required. The SQL Server instance of the database that static data masking is to be applied to.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### Database
Required. The database that static data masking is to be applied to.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 1
Default Value: 
Pipeline Input: false
```

### DataMaskFile
Required. Absolute path to the JSON file generated by invoking New-DbaDbMaskingConfig. The file can be subsequently editted by
hand to suit the data masking requirements of this function's user. Currently, static data masking is only supported for columns with char, varchar, nvarchar, int and bigint data types.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 2
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

## NOTES

Note that it has dependencies on the dbatools module which are installed with this module.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# New-FlashArrayCapacityReport

## SYNOPSIS
Create a formatted report that contains FlashArray Capacity Information

## SYNTAX

### Set 1
```
New-FlashArrayCapacityReport [-EndPoint] <String> [-OutFile <String>] [-HTMLFileName <String>] [-VolumeFilter <String>] [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will retrieve volume and snapshot capacity information from the FlashArray and output it to a formatted report.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
New-FlashArrayCapacityReport -EndPoint myArray
```

Creates a capacity report named myArray_Capacity_Report.html in the current folder.

### -------------------------- EXAMPLE 2 --------------------------
PS C:\\\>
```powershell
New-FlashArrayCapacityReport -EndPoint myArray -OutFile C:\temp -HTMLFileName MyArrayReport.html -VolumeFilter 'Volume1*'.
```

Creates a capacity report c:\\temp\\myArrayReport.html that includes volumes that contain the name 'Volume1\*'.

## PARAMETERS

### EndPoint
Required. FQDN or IP address of FlashArray.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### OutFile
Optional. Full folder path for output report. Default is the current %TEMP% folder.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: "$env:Temp"
Pipeline Input: false
```

### HTMLFileName
Optional. File name of output report. Default is Array_Capacity_Report.html.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: Array_Capacity_Report.html
Pipeline Input: false
```

### VolumeFilter
Optional. Specific volumes to filter output on. Wildcards are accepted. By default, this is "\*" (all).

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: *
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### Formatted HTML report containing retrieved data and specified options.


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# New-FlashArrayDbSnapshot

## SYNOPSIS
A PowerShell function to create a FlashArray snapshot of the volume that a database resides on.

## SYNTAX

### Set 1
```
New-FlashArrayDbSnapshot [-Database] <String> [-SqlInstance] <String> [-Endpoint] <String> [<CommonParameters>]
```

## DESCRIPTION
A PowerShell function to create a FlashArray snapshot of the volume that a database resides on, based in the
values of the following parameters:

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
New-FlashArrayDbSnapshot -Database tpch-no-compression -SqlInstance z-sql2016-devops-prd -Endpoint 10.225.112.10 -Creds $Creds
```

Create a snapshot of FlashArray volume that stores the tpch-no-compression database on the z-sql2016-devops-prd instance

## PARAMETERS

### Database
Required. The name of the database to refresh, note that it is assumed that source and target database(s) are named the same.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### SqlInstance
Required. This can be one or multiple SQL Server instance(s) that host the database(s) to be refreshed, in the case that the
function is invoked  to refresh databases  across more than one instance, the list of target instances should be
spedcified as an array of strings, otherwise a single string representing the target instance will suffice.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 1
Default Value: 
Pipeline Input: false
```

### Endpoint
Required. The IP address representing the FlashArray that the volumes for the source and refresh target databases reside on.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 2
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

## NOTES

FlashArray Credentials - A global variable $Creds may be used as described in the release notes for this module. If neither is specified, the module will prompt for credentials.

Known Restrictions
------------------
1. This function does not work for databases associated with failover cluster instances.
2. This function cannot be used to seed secondary replicas in availability groups using databases in the primary replica.
3. The function assumes that all database files and the transaction log reside on a single FlashArray volume.

Note that it has dependencies on the dbatools and PureStoragePowerShellSDK modules which are installed as part of this module.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# New-FlashArrayPGroupVolumes

## SYNOPSIS
Creates volumes to a new FlashArray Protection Group (PGroup).

## SYNTAX

### Set 1
```
New-FlashArrayPGroupVolumes [-PGroupPrefix] <String> [-VolumeSizeGB] <String> [-NumberOfVolumes] <String> [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will allow for the creation of multiple volumes and adding the created volumes to a new Protection Group (PGroup). The new volume names will default to "$PGroupPrefix-vol1", "PGroupPrefix-vol2" etc.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
New-FlashArrayPGroupVolumes -PGroupPrefix "database" -VolumeSizeGB "200" -NumberOfVolumes "3"
```

Creates 3-200GB volumes, named "database-vol1", "database-vol2", and "database-vol3". Each volume is added to the new Protection Group "database-PGroup".

## PARAMETERS

### PGroupPrefix
Required. The name of the Protection Group prefix to add volumes to. This parameter specifies the prefix of the PGroup name. The suffix defaults to "-PGroup". Example: -PGroupPrefix "database". The full PGroup name will be "database-PGroup".
This PGroup will be created as new and must not already exist on the array.
This prefix will also be used to uniquely name the volumes as they are created.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### VolumeSizeGB
Required. The size of the new volumes in Gigabytes (GB).

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 1
Default Value: 
Pipeline Input: false
```

### NumberOfVolumes
Required. The number of volumes that are to be created. Each volume will be named "vol" with an ascending number following (ie. vol1, vol2, etc.). Each volume name will also contain the $PGroupPrefix variable as the name prefix.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 2
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### None


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# New-HypervClusterVolumeReport

## SYNOPSIS
Creates a Excel report on volumes connected to a Hyper-V cluster.

## SYNTAX

### Set 1
```
New-HypervClusterVolumeReport [-EndPoint] <String> [-VmCsvFileName <String>] [-WinCsvFileName <String>] [-PfaCsvFileName <String>] [-ExcelFile <String>] [<CommonParameters>]
```

## DESCRIPTION
This creates separate CSV files for VM, Windows Hosts, and FlashArray information that is part of a HyperV cluster. It then takes that output and places it into a an Excel workbook that contains sheets for each CSV file.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
New-HypervClusterVolumeReport -EndPoint myarray -VmCsvName myVMs.csv -WinCsvName myWinHosts.csv -PfaCsvName myFlashArray.csv -ExcelFile myExcelFile
```

This will create three separate CSV files with HyperV cluster information and incorporate them into a single Excel workbook.

## PARAMETERS

### EndPoint


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### VmCsvFileName
Optional. Defaults to VMs.csv.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: VMs.csv
Pipeline Input: false
```

### WinCsvFileName
Optional. defaults to WindowsHosts.csv.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: WindowsHosts.csv
Pipeline Input: false
```

### PfaCsvFileName
Optional. defaults to FlashArrays.csv.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: FlashArrays.csv
Pipeline Input: false
```

### ExcelFile
Optional. defaults to HypervClusterReport.xlsx.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: HypervClusterReport.xlxs
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### Endpoint is mandatory. VM, Win, and PFA csv file names are optional.


## OUTPUTS

### Outputs individual CSV files and creates an Excel workbook that is built using the required PowerShell module ImportExcel, created by Douglas Finke.


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# New-VolumeShadowCopy

## SYNOPSIS
Creates a new volume shadow copy using Diskshadow.

## SYNTAX

### Set 1
```
New-VolumeShadowCopy [-Volume] <String[]> [[-ScriptName] <String>] [-ShadowCopyAlias] <String> [[-VerboseMode] <String>] [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will create a new volume shadow copy using the Diskshadow command, passing the variables specified.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
New-VolumeShadowCopy -Volume Volume01 -ShadowCopyAlias MyAlias
```

Adds a new volume shadow copy of Volume01 using Diskshadow with an alias of 'MyAlias'.

## PARAMETERS

### Volume
Required.

```yaml
Type: String[]
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### ScriptName
Optional. Script text file name created to pass to the Diskshadow command. Pre-defined as 'PUREVSS-SNAP'.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 1
Default Value: PUREVSS-SNAP
Pipeline Input: false
```

### ShadowCopyAlias
Required. Name of the shadow copy alias.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 2
Default Value: 
Pipeline Input: false
```

### VerboseMode
Optional. "On" or "Off". If set to 'off', verbose mode for the Diskshadow command is disabled. Default is 'on'.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 3
Default Value: On
Accepted Values: On
                 Off
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### None


## NOTES

See https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow for more information on the Diskshadow utility.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Register-HostVolumes

## SYNOPSIS
Sets Pure FlashArray connected disks to online.

## SYNTAX

### Set 1
```
Register-HostVolumes [[-ComputerName] <String>] [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will set any FlashArray volumes (disks) to online in Windows using the diskpart command.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Register-HostVolumes -ComputerName myComputer
```

Sets all FlashArray disks for myComputer to online.

## PARAMETERS

### ComputerName


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### None


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Remove-FlashArrayPendingDeletes

## SYNOPSIS
Reports on pending FlashArray Volume and Snapshots deletions and optionally Eradicates them.

## SYNTAX

### Set 1
```
Remove-FlashArrayPendingDeletes [-EndPoint] <String> [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will return information on any volumes or volume snapshots that are pending eradication after deletion and optionally prompt for eradication of those objects. The user will be prompted for confirmation.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Remove-FlashArrayPendingDelete -EndPoint myArray
```

## PARAMETERS

### EndPoint


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### Volume and volume snapshots awaiting eradication.


## NOTES

This cmdlet can utilize the global $Creds variable for FlashArray authentication. Set the variable $Creds by using the command $Creds = Get-Credential.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Set-MPIODiskLBPolicy

## SYNOPSIS
Sets the MPIO Load Balancing policy for FlashArray disks.

## SYNTAX

### Set 1
```
Set-MPIODiskLBPolicy [-Policy] <String> [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will set the MPIO Load Balancing policy for all connected Pure FlashArrays disks to the desired setting using the mpclaim.exe utlity.
The default Windows OS setting is RR.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Set-MPIODiskLBPolicy -Policy LQD
```

Sets the MPIO load balancing policy for all Pure disks to Least Queue Depth.

### -------------------------- EXAMPLE 2 --------------------------
PS C:\\\>
```powershell
Set-MPIODiskLBPolicy -Policy clear
```

Clears the current MPIO policy for all Pure disks and sets to the default of RR.

## PARAMETERS

### Policy


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Accepted Values: LQD
                 RR
                 clear
                 FO
                 RRWS
                 WP
                 LB
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### None


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Set-TlsVersions

## SYNOPSIS
Sets the TLS Version in the local registry.

## SYNTAX

### Set 1
```
Set-TlsVersions [<CommonParameters>]
```

## DESCRIPTION
This cmdlet disables TLS version 1.0 and enables TLS Versions 1.1, 1.2, and 1.3 in the local registry. It will prompt for creating a backup of the registry before execution for recovery purposes.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Set-TlsVersions
```

Prompts for creation of a registry backup, disables TLS version 1.0, and enables TLS versions 1.1, 1.2, and 1.3.

## PARAMETERS

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### Backup of the registry before the changes are implemented.


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Set-WindowsPowerScheme

## SYNOPSIS
Cmdlet to set the Power scheme for the Windows OS to High Performance.

## SYNTAX

### Set 1
```
Set-WindowsPowerScheme [[-ComputerName] <String>] [<CommonParameters>]
```

## DESCRIPTION
Cmdlet to set the Power scheme for the Windows OS to High Performance.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Set-WindowsPowerScheme
```

Retrieves the current Power Scheme setting, and if not set to High Performance, asks for confirmation to set it.

## PARAMETERS

### ComputerName


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### Current power scheme and optional confirmation to alter the setting in the Windows registry.


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Sync-FlashArrayHosts

## SYNOPSIS
Synchronizes the hosts amd host protocols between two FlashArrays.

## SYNTAX

### Set 1
```
Sync-FlashArrayHosts [-SourceArray] <String> [-TargetArray] <String> -Protocol <String> [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will retrieve the current hosts from the Source array and create them on the target array. It will also add the FC (WWN) or iSCSI (iqn) settings for each host on the Target array.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Sync-FlashArraysHosts -SourceArray mySourceArray -TargetArray myTargetArray -Protocol FC
```

Synchronizes the hosts and hosts FC WWNs from the mySourceArray to the myTargetArray.

## PARAMETERS

### SourceArray
Required. FQDN or IP address of the source FlashArray.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### TargetArray
Required. FQDN or IP address of the source FlashArray.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 1
Default Value: 
Pipeline Input: false
```

### Protocol
Required. 'FC' for Fibre Channel WWNs or 'iSCSI' for iSCSI IQNs.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: named
Default Value: 
Accepted Values: iSCSI
                 FC
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### None


## NOTES

This cmdlet cannot utilize the global $Creds variable as it requires two logins to two separate arrays.

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Test-WindowsBestPractices

## SYNOPSIS
Cmdlet used to retrieve hosts information, test and optionally configure MPIO (FC) and/or iSCSI settings in a Windows OS against FlashArray Best Practices.

## SYNTAX

### Set 1
```
Test-WindowsBestPractices [[-OutFile] <String>] [-EnableIscsiTests] [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will retrieve the curretn host infromation, and iterate through several tests around MPIO (FC) and iSCSI OS settings and hardware, indicate whether they are adhearing to Pure Storage FlashArray Best Practices, and offer to alter the settings if applicable.
All tests can be bypassed with a negative user response when prompted, or simply by using Ctrl-C to break the process.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Test-WindowsBestPractices
```

Run the cmdlet against the local machine running the MPIO tests and the log is located in the %TMP%\\Test-WindowsBestPractices.log file.

### -------------------------- EXAMPLE 2 --------------------------
PS C:\\\>
```powershell
Test-WindowsZBestPractices -EnableIscsiTests -OutFile "c:\temp\mylog.log"
```

Run the cmdlet against the local machine, run the additional iSCSI tests, and create the log file at c:\\temp\\mylog.log.

## PARAMETERS

### OutFile
Optional. Specify the full filepath (ex. c:\\mylog.log) for logging. If not specified, the default file of %TMP%\\Test-WindowsBestPractices.log will be used.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 0
Default Value: "$env:Temp\Test-WindowsBestPractices.log"
Pipeline Input: false
```

### EnableIscsiTests
Optional. If this parameter is present, the cmdlet will run tests for iSCSI settings.

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### Optional parameter for iSCSI testing.


## OUTPUTS

### Output status and best practice options for every test.


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Unregister-HostVolumes

## SYNOPSIS
Sets Pure FlashArray connected disks to offline.

## SYNTAX

### Set 1
```
Unregister-HostVolumes [[-Computername] <String>] [<CommonParameters>]
```

## DESCRIPTION
This cmdlet will set any FlashArray volumes (disks) to offline in Windows using the diskpart command.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Unregister-HostVolumes -ComputerName myComputer
```

Offlines all FlashArray disks from myComputer.

## PARAMETERS

### Computername


```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 0
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### None


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*



# Update-DriveInformation

## SYNOPSIS
Updates drive letters and assigns a label.

## SYNTAX

### Set 1
```
Update-DriveInformation [-NewDriveLetter] <String> [-CurrentDriveLetter] <String> [[-NewDriveLabel] <String>] [<CommonParameters>]
```

## DESCRIPTION
Thsi cmdlet will update the current drive letter to the new drive letter, and assign a new drive label if specified.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
Update-DriveInformation -NewDriveLetter S -CurrentDriveLetter M
```

Updates the drive letter from M: to S: and labels S: to NewDrive.

## PARAMETERS

### NewDriveLetter
Required. Drive lettwre without the colon.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 0
Default Value: 
Pipeline Input: false
```

### CurrentDriveLetter
Required. Drive lettwre without the colon.

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: true
Position: 1
Default Value: 
Pipeline Input: false
```

### NewDriveLabel
Optional. Drive label text. Defaults to "NewDrive".

```yaml
Type: String
Parameter Sets: Set 1
Aliases: 

Required: false
Position: 2
Default Value: NewDrive
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None


## OUTPUTS

### None


## NOTES

## RELATED LINKS


*Generated by: PowerShell HelpWriter 2021 v2.3.50*

